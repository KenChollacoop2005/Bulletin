<div
  class="poster SaturnCD"
  style="
    --active-scale: 1.7;
    top: 58%;
    left: 22%;
    transform: rotate(6deg);
    background-color: transparent;
    width: 167px;
    height: 147px;
    position: absolute;
    overflow: visible;
    perspective: 1200px; /* depth for 3D flip */
  "
>
  <!-- Panel 1 (Cover Panel) -->
  <div
    class="panel panel1"
    style="
      z-index: 2;
      position: absolute;
      inset: 0;
      transform-style: preserve-3d;
      transform-origin: left center;
    "
  >
    <!-- Front: CD Cover -->
    <div
      class="face front"
      style="position: absolute; inset: 0; backface-visibility: hidden"
    >
      <img
        src="Assets/SaturnCDcover.png"
        alt="Saturn CD Cover"
        style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          image-rendering: -webkit-optimize-contrast;
          image-rendering: crisp-edges;
          backface-visibility: hidden;
          transform: translateZ(0);
          will-change: transform;
          position: absolute;
          top: 0;
          left: 0;
          pointer-events: none;
        "
      />
    </div>

    <!-- Back: Inside Left - Now with SaturnCDleft.png -->
    <div
      class="face back"
      style="
        position: absolute;
        inset: 0;
        backface-visibility: hidden;
        transform: rotateY(-180deg);
      "
    >
      <img
        src="Assets/SaturnCDleft.png"
        alt="Inside Left"
        style="
          width: auto;
          height: auto;
          max-width: 1100px;
          max-height: 2560px;
          object-fit: cover;
          image-rendering: -webkit-optimize-contrast;
          image-rendering: crisp-edges;
          backface-visibility: hidden;
          transform: scale(0.226) translateX(0px);
          will-change: transform;
          position: absolute;
          top: -252px;
          left: -296px;
          pointer-events: none;
        "
      />

      <!-- ============================================================= -->
      <!-- ü™ê Module image loading and class settingü™ê -->
      <!-- ============================================================= -->

      <!-- Saturn module container (inside the back face, after the background image) -->
      <div class="saturn-modules">
        <!-- üéØ Enceladus Module with hitbox -->
        <div id="module-Enceladus" class="saturn-module">
          <img
            src="Assets/SaturnModulars/Enceladus.png"
            alt="Saturn Module - Enceladus"
            class="module-image"
          />
          <!-- üîπ Hitbox for precise hover -->
          <div id="module-Enceladus-hitbox"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Panel 2 (Right Panel / Inside Right) -->
  <div
    class="panel panel2"
    style="
      z-index: 1;
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      background: transparent;
      color: #222;
      overflow: visible;
      transform-style: preserve-3d; /* needed for CD disk movement */
    "
  >
    <img
      src="Assets/SaturnCDright.png"
      alt="Inside Right"
      style="
        width: auto;
        height: auto;
        max-width: 1100px;
        max-height: 2560px;
        object-fit: cover;
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
        transform: scale(0.226) translateX(-5px);
        overflow: visible;
        will-change: transform;
      "
    />

    <!-- CD Disk - Skinned with SaturnCDdisk.png -->
    <div
      class="cd-disk"
      style="
        position: absolute;
        top: 0px;
        left: 15.4px;
        width: 100%;
        height: 100%;
        background-color: transparent;
        z-index: 2; /* above panel 2 content */
        pointer-events: none;
        will-change: transform;
        overflow: hidden;
      "
    >
      <img
        id="saturn-cd-disk"
        src="Assets/SaturnCDdisk.png"
        alt="Saturn CD Disk"
        data-rotation="0"
        style="
          width: 147px;
          height: 147px;
          object-fit: cover;
          image-rendering: -webkit-optimize-contrast;
          image-rendering: crisp-edges;
          backface-visibility: hidden;
          transform: rotate(0deg);
          will-change: transform;
          position: absolute;
          top: 0;
          left: 0;
          z-index: 2;
          pointer-events: auto;
          transition: transform 0.4s ease;
        "
      />
    </div>
    <!-- üé∂ CD Music Note Layer (NEW) -->
    <div class="cd-note-layer"></div>
  </div>

  <!-- Clickable overlay for right panel -->
  <div
    class="SaturnCD-right-click"
    style="
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      background: transparent;
      z-index: 3;
    "
  ></div>

  <style>
    /* Poster zoom and reposition when active */
    .poster-active.SaturnCD {
      transform: scale(4) !important;
      top: 40% !important;
      left: 70% !important;
    }

    /* Open/close transition for Panel 1 */
    .SaturnCD .panel1 {
      transform: rotateY(0deg);
      transform-style: preserve-3d;
      transform-origin: left center;
      transition: transform 0.8s ease 0.6s;
    }
    .SaturnCD:not(.poster-active) .panel1 {
      transition: transform 0.4s ease 0s;
    }
    .poster-active.SaturnCD .panel1 {
      transform: rotateY(-180deg);
    }

    /* Enable clicking on right panel when open */
    .poster-active.SaturnCD .SaturnCD-right-click {
      pointer-events: auto;
    }

    /* ---------- CD Disk sliding behavior ---------- */
    .cd-disk {
      transition: transform 1s cubic-bezier(0.25, 0.8, 0.25, 1) 1s;
    }

    /* Slide the container to the right */
    .poster-active.SaturnCD .panel2 .cd-disk {
      transform: translateX(49px) translateY(8px) rotate(45deg);
    }

    /* Rotate the image inside */
    .poster-active.SaturnCD .panel2 #saturn-cd-disk {
      transform: rotate(45deg);
    }

    /* Reset states when closed */
    .SaturnCD:not(.poster-active) .panel2 .cd-disk {
      transform: translateX(0);
      transition: transform 0.4s ease 0s;
    }

    .SaturnCD:not(.poster-active) .panel2 #saturn-cd-disk {
      transform: rotate(0deg);
      transition: transform 0.4s ease 0s;
    }
    /* ============================================================================================================================ */
    /* üé∂ SATURN CD ‚Äî MUSIC NOTE EMISSION SYSTEM üé∂ */
    /* ============================================================================================================================ */

    .cd-note-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: visible;
      z-index: 1;
    }

    /* Individual music note */
    .cd-music-note {
      position: absolute;
      left: 110%;
      top: 20%;
      width: 60px; /* scale down your 400px√ó200px PNG */
      height: auto;
      pointer-events: none;
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
      transform: translate(-50%, -50%) rotate(var(--rot));
      animation: cdNoteFloat var(--dur) linear forwards;
    }

    @keyframes cdNoteFloat {
      0% {
        transform: translate(-50%, -50%) translate(0, 0) scale(0.85)
          rotate(var(--rot));
        opacity: 1;
      }

      25% {
        transform: translate(-50%, -50%)
          translate(calc(var(--x) * 0.25), calc(var(--y) * 0.25)) scale(0.9)
          rotate(calc(var(--rot) + 10deg));
      }

      50% {
        transform: translate(-50%, -50%)
          translate(calc(var(--x) * 0.5), calc(var(--y) * 0.5)) scale(1)
          rotate(calc(var(--rot) - 10deg));
      }

      75% {
        transform: translate(-50%, -50%)
          translate(calc(var(--x) * 0.75), calc(var(--y) * 0.75)) scale(1.05)
          rotate(calc(var(--rot) + 5deg));
      }

      100% {
        transform: translate(-50%, -50%) translate(var(--x), var(--y))
          scale(1.15) rotate(calc(var(--rot) - 5deg));
        opacity: 0;
      }
    }

    /* ============================================================================================================================ */
    /* ü™ê SATURN CD ‚Äî MODULE SYSTEM CODE STARTS BELOW THIS LINE ü™ê */
    /* ============================================================================================================================ */

    /* üß± Saturn Module Container (parent) */
    .saturn-modules {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: visible;
      pointer-events: none; /* container doesn't block, but children can have events */
    }

    /* üéØ Enceladus module image */
    #module-Enceladus {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 1; /* visible now */
    }

    #module-Enceladus .module-image {
      width: auto;
      height: auto;
      max-width: 1100px;
      max-height: 2560px;
      object-fit: cover;
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
      transform: scale(0.226) translateX(0px);
      position: absolute;
      top: -252px;
      left: -296px;
      pointer-events: none; /* hover is now controlled by hitbox */
      transition: filter 0.3s ease; /* smooth glow */
    }

    /* üîπ Hitbox for precise hover over Enceladus */
    #module-Enceladus-hitbox {
      position: absolute;
      top: 115px; /* adjust as needed */
      left: 113px; /* adjust as needed */
      width: 32px; /* adjust to match visible module */
      height: 26px; /* adjust to match visible module */
      background-color: rgba(
        0,
        0,
        255,
        0.2
      ); /* translucent blue for positioning */
      cursor: pointer;
      pointer-events: auto;
      transition: background-color 0.3s ease;
    }

    /* Hover on the parent container when hitbox is hovered */
    #module-Enceladus:hover .module-image {
      filter: drop-shadow(0 0 8px yellow)
        drop-shadow(0 0 12px rgba(255, 255, 0, 0.7));
    }
    /* Glow effect class (same as hover) */
    #module-Enceladus.glow .module-image {
      filter: drop-shadow(0 0 8px yellow)
        drop-shadow(0 0 12px rgba(255, 255, 0, 0.7));
    }
  </style>

  <script>
    // üß† Saturn CD Module System Logic (Enceladus ready)
    console.log("Saturn module system initialized - Enceladus loaded");

    // Variable to track which mouthpiece is selected
    let MouthpieceSelected = null;

    // Function to apply glow if Enceladus is selected
    function updateMouthpieceGlow() {
      const enceladusModule = document.getElementById("module-Enceladus");
      if (MouthpieceSelected === "Enceladus") {
        enceladusModule.classList.add("glow");
      } else {
        enceladusModule.classList.remove("glow");
      }
    }

    // Click listener on the hitbox to select Enceladus
    const enceladusHitbox = document.getElementById("module-Enceladus-hitbox");
    if (enceladusHitbox) {
      enceladusHitbox.addEventListener("click", () => {
        MouthpieceSelected = "Enceladus";
        updateMouthpieceGlow();
        console.log("Enceladus selected via click!");
      });
    }

    // Optional: initialize
    updateMouthpieceGlow();
  </script>
</div>
